const O=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}};O();const y=(e,t)=>e.x===t.x&&e.y===t.y,P=({x:e,y:t})=>e>0&&e<11&&t>0&&t<11,H=(e,t)=>({x:t?11-e:10,y:t?10:11-e}),q=(e,t,r)=>Array.from({length:e}).map((o,n)=>({x:r?t.x+n:t.x,y:r?t.y:t.y+n}));function M(e,t){return t.forEach(r=>{if(P(r)===!1)throw new Error(`point ${r.x}, ${r.y} out of bounds.`);r.isHit=!1,r.isSunk=!1}),{get name(){return e},get pointlist(){return t},hit(r){var n;let o=t.findIndex(s=>y(s,r));return((n=t[o])==null?void 0:n.isHit)===!1?(t[o].isHit=!0,this.isSunk()&&t.forEach(s=>s.isSunk=!0),!0):!1},isSunk(){return t.every(r=>r.isHit)}}}const T=(e,t)=>e.some(r=>t.some(o=>y(r,o))),z=e=>e.every(t=>t.isSunk());function $(){const e=[],t=[];return{get attacklist(){return[...t]},addShip(r){return e.some(o=>T(o.pointlist,r.pointlist))?!1:(e.push(r),!0)},recieveAttack(r){let o=r;const n=e.find(l=>l.hit(r)?l:!1),s=n!==void 0?n.isSunk():!1,c=z(e);return n?(o=n.pointlist.find(l=>y(l,r)),t.push(o)):o.isMiss=!0,t.push(o),{returnPoint:o,isHit:n!==void 0,isSunk:s?n.name:!1,isAllSunk:c}}}}const C=e=>({gameboard:$(),isComputer:e}),F=({gameboard:e})=>{let t;do t={x:S(),y:S()};while(e.attacklist.some(r=>y(r,t)));return t},S=()=>Math.floor(Math.random()*10)+1,E=e=>({x:e%10+1,y:Math.floor(e/10)+1}),m=({x:e,y:t})=>e-1+(t-1)*10,N=async(e,t)=>{const r=document.querySelector(".gamegrid"),o=Array.from(r.children),n={container:r,centerContainer:document.querySelector(".centerContainer"),children:o,turnLabel:document.querySelector(".turn"),addEvent:()=>r.addEventListener("click",c),removeEvent:()=>r.removeEventListener("click",c)};let s=!0;n.turnLabel.textContent="Player 1's Turn",n.centerContainer.textContent="Battleship has started!",n.centerContainer.style.animation="attackMessage 3s",n.centerContainer.style.zIndex="1",await v(3),n.centerContainer.style.animation="",n.centerContainer.style.zIndex="";const c=async({target:l})=>{const d=o.indexOf(l);if(d>-1){if(s===!1&&t)return;await e(n,s,E(d)),s=!s,s===!1&&t&&(await e(n,!1,{x:0,y:0}),s=!0)}};n.addEvent()};function L(e,t){N(G(e,t),t.isComputer)}const w=e=>e.isSunk?"black":e.isHit?"red":"white",D=e=>e.isAllSunk?"You win!":e.isSunk?`${e.isSunk} has been sunk!`:e.isHit?"Hit!":"Miss.",v=async e=>new Promise(t=>setTimeout(t,e*1e3)),G=(e,t)=>{let r=!1;return async(o,n,s)=>{const c=n?e:t,l=n?t:e;if(r||l.gameboard.attacklist.some(i=>y(i,s)))return;r=!0,n===!1&&t.isComputer&&(s=F(e));const d=l.gameboard.recieveAttack(s);o.children[m(s)].style.background=w(d.returnPoint),d.isSunk&&l.gameboard.attacklist.forEach(i=>{i.isSunk&&(o.children[m(i)].style.backgroundColor="black")}),o.centerContainer.textContent=D(d),o.centerContainer.style.animation="attackMessage 3s",o.centerContainer.style.zIndex="1",await v(3),!d.isAllSunk&&(o.centerContainer.style.animation="",o.centerContainer.style.zIndex="",o.children.forEach(i=>i.style.backgroundColor="navy"),await v(1),c.gameboard.attacklist.forEach(i=>{const a=o.children[m(i)];a.style.backgroundColor=w(i)}),o.turnLabel.textContent=`Player ${n?"2":"1"}'s Turn`,o.addEvent(),r=!1)}},A=()=>[{name:"Aircraft Carrier",length:5,pointlist:[]},{name:"Battleship",length:4,pointlist:[]},{name:"Crusier",length:3,pointlist:[]},{name:"Destroyer",length:2,pointlist:[]},{name:"Destroyer",length:2,pointlist:[]},{name:"Submarine",length:1,pointlist:[]},{name:"Submarine",length:1,pointlist:[]}],u=(()=>{const e=document.querySelector(".gamegrid"),t=Array.from(e.children);return{container:e,children:t,centerContainer:document.querySelector(".centerContainer"),turn:document.querySelector(".turn")}})(),b=document.querySelector(".shipSelectionContainer"),x=Array.from(document.querySelector(".shipButtonContainer").children),k=document.querySelector(".doneButton");let h=0,p=!1;x.forEach((e,t)=>e.addEventListener("click",()=>h=t));var B;(B=document.querySelector(".rotate"))==null||B.addEventListener("click",()=>p=!p);b.remove();const K=(e,t)=>{const r=H(e.length,t);return t&&e[0].x>r.x||t===!1&&e[0].y>r.y},Y=(e,t,r)=>t.filter(({pointlist:o},n)=>o.length>0&&n!==r).some(({pointlist:o})=>o.some(n=>e.some(s=>y(n,s)))),I=(e,t,r,o)=>K(e,r)===!1&&Y(e,t,o)===!1,_=()=>{const e=A();return e.forEach((t,r)=>{let o,n;do n=j(),o=q(t.length,{x:S(),y:S()},n);while(I(o,e,n,r)===!1);t.pointlist=o}),e},g=async(e,t)=>{var d;u.centerContainer.textContent=`Player ${t?"1":"2"} Ship Selection`,u.turn.textContent=`Player ${t?"1":"2"}'s Turn`,u.centerContainer.style.animation="attackMessage 3s",u.centerContainer.style.zIndex="1",await v(3),u.centerContainer.style.animation="",u.centerContainer.style.zIndex="-1",(d=document.querySelector("#app"))==null||d.appendChild(b);const r=A(),o=()=>u.children.forEach(i=>{i.addEventListener("mouseover",s),i.addEventListener("mouseleave",c),i.addEventListener("click",l)}),n=i=>{const a=q(r[h].length,E(u.children.indexOf(i)),p);return I(a,r,p,h)?a:!1},s=i=>{const a=n(i.target);a!==!1&&a.forEach(f=>u.children[m(f)].style.backgroundColor=i.type==="mouseover"?"rgba(100, 100, 100, .5)":"gray")},c=()=>{u.children.forEach(i=>i.style.backgroundColor=r.some(({pointlist:a})=>a.some(f=>y(E(u.children.indexOf(i)),f)))?"gray":"navy")},l=i=>{const a=n(i.target);a!==!1&&(r[h].pointlist.forEach(f=>u.children[m(f)].style.backgroundColor="navy"),s(i),r[h].pointlist=a,x[h].style.backgroundColor="rgb(80, 255, 40)",r.every(({pointlist:f})=>f.length>0)&&(k.style.visibility="visible"))};return o(),new Promise(i=>{k.addEventListener("click",()=>{u.children.forEach(a=>{a.removeEventListener("mouseover",s),a.removeEventListener("mouseleave",c),a.removeEventListener("click",l)}),r.forEach(({name:a,pointlist:f})=>e.gameboard.addShip(M(a,f))),u.children.forEach(a=>a.style.backgroundColor=""),x.forEach(a=>a.style.backgroundColor=""),k.style.visibility="hidden",b.remove(),h=0,p=!1,i()})})},j=()=>Math.round(Math.random())===1,J=async()=>{const e=document.querySelector(".centerContainer"),t=document.createElement("h1"),r=document.createElement("button"),o=document.createElement("button");t.textContent="Battleship",r.textContent="Computer",o.textContent="2 Player",[r,o].forEach(s=>s.className="menuButton"),[t,r,o].forEach(s=>e.appendChild(s)),e.style.opacity="1",e.style.zIndex="1";const n=()=>{e.textContent="",e.style.opacity="0",e.style.zIndex="-1"};o.addEventListener("click",()=>{n();const s=C(!1),c=C(!1);g(s,!0).then(()=>g(c,!1)).then(()=>L(s,c))}),r.addEventListener("click",()=>{n();const s=C(!1),c=C(!0),l=_();console.log(l),l.forEach(({name:d,pointlist:i})=>c.gameboard.addShip(M(d,i))),g(s,!0).then(()=>L(s,c))})};J();
